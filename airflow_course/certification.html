<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FKTI - Airflow Certification Exam | 75 Questions Study Guide</title>
    <link rel="stylesheet" href="../css/minimalistic-theme.css">
    <link rel="stylesheet" href="../assets/design-system.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Certification Page Specific Styles */
        .cert-header {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
            border: 2px solid #0077be;
        }
        
        .cert-header h2 {
            color: #0077be;
            margin-bottom: 0.5rem;
        }
        
        .cert-header p {
            color: #005a8b;
            font-size: 1.1rem;
        }
        
        .mode-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
        }
        
        .mode-btn.study {
            background: linear-gradient(135deg, #0077be 0%, #00a8f3 100%);
            color: white;
        }
        
        .mode-btn.quiz {
            background: linear-gradient(135deg, #ff9800 0%, #ffc107 100%);
            color: white;
        }
        
        .mode-btn.answers {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }
        
        .mode-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.25);
        }
        
        .mode-btn.active {
            box-shadow: 0 0 0 4px rgba(0, 119, 190, 0.4);
        }
        
        .cert-section {
            display: none;
        }
        
        .cert-section.active {
            display: block;
        }
        
        .question-card {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 5px solid #0077be;
            transition: all 0.3s ease;
        }
        
        .question-card:hover {
            box-shadow: 0 4px 15px rgba(0, 119, 190, 0.15);
            transform: translateX(5px);
        }
        
        .q-number {
            display: inline-block;
            background: linear-gradient(135deg, #0077be 0%, #00a8f3 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .q-category {
            display: inline-block;
            background: #e3f2fd;
            color: #0077be;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            margin-left: 8px;
            font-weight: 500;
        }
        
        .q-text {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: #333;
            line-height: 1.5;
        }
        
        .q-text pre {
            background: #282c34;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        
        .options-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .option-item:hover {
            border-color: #0077be;
            background: #f0f8ff;
        }
        
        .option-item input[type="radio"],
        .option-item input[type="checkbox"] {
            margin-right: 12px;
            accent-color: #0077be;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .option-item.correct-highlight {
            border-color: #4caf50 !important;
            background: #e8f5e9 !important;
        }
        
        .option-item.correct-highlight::after {
            content: ' ‚úì';
            color: #4caf50;
            font-weight: bold;
            margin-left: auto;
        }
        
        .option-item.user-correct {
            border-color: #4caf50 !important;
            background: #e8f5e9 !important;
        }
        
        .option-item.user-wrong {
            border-color: #f44336 !important;
            background: #ffebee !important;
        }
        
        .explanation-box {
            margin-top: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f8ff 100%);
            border-left: 4px solid #0077be;
            border-radius: 0 8px 8px 0;
        }
        
        .explanation-box h4 {
            color: #0077be;
            margin-bottom: 8px;
            font-size: 1rem;
        }
        
        .explanation-box p {
            color: #555;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .explanation-box code {
            background: #e8e8e8;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #0077be;
        }
        
        .correct-badge {
            display: inline-block;
            background: #e8f5e9;
            color: #2e7d32;
            padding: 5px 12px;
            border-radius: 5px;
            font-weight: 600;
            margin-top: 10px;
        }
        
        /* Quiz Results */
        .quiz-results {
            background: linear-gradient(135deg, #f0f8ff 0%, #e3f2fd 100%);
            border: 2px solid #0077be;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .score-display {
            font-size: 4rem;
            font-weight: 700;
            background: linear-gradient(135deg, #0077be 0%, #00a8f3 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .score-label {
            font-size: 1.2rem;
            color: #555;
            margin-top: 10px;
        }
        
        .score-label.pass {
            color: #2e7d32;
            font-weight: bold;
        }
        
        .score-label.fail {
            color: #c62828;
            font-weight: bold;
        }
        
        .progress-track {
            width: 100%;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0077be, #00a8f3);
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        
        .stats-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
        }
        
        .stat-box {
            text-align: center;
        }
        
        .stat-num {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .stat-num.correct {
            color: #4caf50;
        }
        
        .stat-num.wrong {
            color: #f44336;
        }
        
        .stat-lbl {
            color: #666;
            font-size: 0.9rem;
        }
        
        .quiz-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, #0077be 0%, #00a8f3 100%);
            color: white;
        }
        
        .action-btn.secondary {
            background: #f5f5f5;
            color: #333;
            border: 2px solid #e0e0e0;
        }
        
        .action-btn.success {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .hidden {
            display: none !important;
        }
        
        /* Scroll to top button */
        .scroll-top-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #0077be 0%, #00a8f3 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 119, 190, 0.4);
        }
        
        .scroll-top-btn.visible {
            opacity: 1;
        }
        
        .scroll-top-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 119, 190, 0.5);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .mode-buttons {
                flex-direction: column;
                padding: 0 1rem;
            }
            
            .mode-btn {
                width: 100%;
            }
            
            .stats-row {
                flex-direction: column;
                gap: 1rem;
            }
            
            .question-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <img src="logo.svg" alt="FKTI Logo" class="logo">
                <div class="header-text">
                    <h1>üìú Airflow Certification Exam</h1>
                    <p class="institute-name">FKTI - Fakhruddin Khambaty Training Institute</p>
                    <p class="tagline">75 Questions - Complete Study Guide</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav id="navbar">
        <div class="container">
            <div class="nav-section">
                <button class="nav-btn hub-btn" onclick="goToHub()">‚Üê FKTI Hub</button>
            </div>
            <div class="nav-section main-nav">
                <button class="nav-btn" onclick="window.location.href='index.html'">üè† Course Home</button>
                <button class="nav-btn" onclick="window.location.href='index.html#basics'">üöÄ Basics</button>
                <button class="nav-btn" onclick="window.location.href='index.html#exercises'">üéØ Exercises</button>
                <button class="nav-btn" style="background: linear-gradient(135deg, #ff9800, #ffc107);">üìú Certification</button>
            </div>
            <div class="nav-section">
                <button class="nav-btn python-btn" onclick="goToPython()">üêç Python Course</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">
        <div class="cert-header">
            <h2>üéì Apache Airflow Certification Exam Preparation</h2>
            <p>Master all 75 questions to ace your Airflow certification!</p>
        </div>

        <div class="mode-buttons">
            <button class="mode-btn study active" onclick="showMode('study')">üìö Study Mode</button>
            <button class="mode-btn quiz" onclick="showMode('quiz')">‚úçÔ∏è Take Quiz</button>
            <button class="mode-btn answers" onclick="showMode('answers')">‚úÖ Answer Key</button>
        </div>

        <!-- STUDY SECTION -->
        <div id="study-section" class="cert-section active">
            <div id="study-content"></div>
        </div>

        <!-- QUIZ SECTION -->
        <div id="quiz-section" class="cert-section">
            <div class="quiz-results hidden" id="results">
                <div class="score-display" id="score-value">0%</div>
                <div class="score-label" id="score-message">Your Score</div>
                <div class="progress-track">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <div class="stats-row">
                    <div class="stat-box">
                        <div class="stat-num correct" id="correct-count">0</div>
                        <div class="stat-lbl">Correct</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-num wrong" id="incorrect-count">0</div>
                        <div class="stat-lbl">Incorrect</div>
                    </div>
                </div>
            </div>
            <div class="quiz-actions">
                <button class="action-btn primary" onclick="submitQuiz()" id="submit-btn">üìù Submit Quiz</button>
                <button class="action-btn success hidden" onclick="revealAnswers()" id="show-answers-btn">üëÅÔ∏è Show Answers</button>
                <button class="action-btn secondary" onclick="resetQuiz()">üîÑ Reset Quiz</button>
            </div>
            <div id="quiz-content"></div>
        </div>

        <!-- ANSWERS SECTION -->
        <div id="answers-section" class="cert-section">
            <div id="answers-content"></div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <img src="logo.svg" alt="FKTI Logo" class="footer-logo">
                <div class="footer-text">
                    <h3>FKTI - Fakhruddin Khambaty Training Institute</h3>
                    <p>Building the next generation of Data Engineers üöÄ</p>
                    <p class="copyright">¬© 2025 FKTI. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <button class="scroll-top-btn" id="scroll-top" onclick="scrollToTop()">‚Üë</button>

    <script>
        const questions = [
            { id: 1, question: "Assume an Airflow variable with the name airtable_api_key was created via the Airflow UI. Will the variable's value be hidden on the Airflow UI?", options: ["Yes", "No"], correct: [0], type: "single", category: "Variables", explanation: "Airflow automatically masks variables containing sensitive keywords in their names. The variable 'airtable_api_key' contains 'api_key', which is one of the keywords Airflow looks for. Other keywords include: password, secret, passwd, authorization, access_token, private_key." },
            { id: 2, question: "Take a look at the code below from a .env file that creates a PostgreSQL connection:\n\nAIRFLOW_CONN_POSTGRES='my-conn-type://login:password@host:port/schema?'\n\nIs this the correct way to create a connection using an environment variable?", options: ["Yes", "No"], correct: [1], type: "single", category: "Connections", explanation: "This is NOT correct. The connection type 'my-conn-type' is invalid. For PostgreSQL, it should be 'postgresql' or 'postgres'. The correct format would be: AIRFLOW_CONN_POSTGRES='postgresql://login:password@host:port/schema'" },
            { id: 3, question: "What is a DAG run?", options: ["A special Airflow object that determines the schedule of a DAG", "A specific run or instance of a task", "A specific run or instance of a DAG", "An object grouping all DAGs"], correct: [2], type: "single", category: "Core Concepts", explanation: "A DAG run represents a single execution of a DAG at a specific point in time. Each DAG run has a run_id, logical_date (execution_date), data_interval, and state." },
            { id: 4, question: "Examine the DAG with 5 tasks (task_a, task_b, task_c, task_d, task_e) where:\n[task_a(), task_b()] >> task_e()\n[task_c(), task_d()] >> task_e()\n\nHow many tasks will run at the same time if this DAG is unpaused?", options: ["4", "1", "0", "2"], correct: [0], type: "single", category: "Dependencies", explanation: "4 tasks will run at the same time. task_a, task_b, task_c, and task_d have no upstream dependencies, so they all start immediately and run in parallel. task_e waits for all four to complete." },
            { id: 5, question: "Which feature in Airflow allows tasks to communicate with each other and share data?", options: ["Variables", "Connections", "XCom", "Hooks"], correct: [2], type: "single", category: "Core Concepts", explanation: "XCom (Cross-Communication) is Airflow's mechanism for tasks to exchange small amounts of data between each other. Tasks can push (send) and pull (receive) data via XCom." },
            { id: 6, question: "If a DAG has a schedule parameter with @daily and catchup set to True, how far back in time will Airflow try to catch up on missed DAG runs?", options: ["To the beginning of time", "One week", "One month", "To the DAG's start_date"], correct: [3], type: "single", category: "Scheduling", explanation: "When catchup=True, Airflow will create DAG runs for all missed intervals between the start_date and the current date." },
            { id: 7, question: "A member of a data team writes a Python script that downloads data from an API and stores it in a database on a daily basis. Is this scenario a use case for Airflow?", options: ["Yes", "No"], correct: [0], type: "single", category: "Use Cases", explanation: "Yes! This is an ideal use case for Airflow. Scheduled, recurring data pipelines are exactly what Airflow is designed for." },
            { id: 8, question: "Assume a DAG should only run for the next two months. Which DAG parameter can help accomplish this goal?", options: ["start_date", "schedule", "end_date", "catchup"], correct: [2], type: "single", category: "DAG Parameters", explanation: "The end_date parameter tells Airflow to stop scheduling DAG runs after a specific date." },
            { id: 9, question: "A team member adds a new task to an existing DAG but doesn't see it in the UI after saving. The DAG file has my_dag() call missing. What is the most likely reason?", options: ["The schedule parameter is missing", "The task dependency setup is incorrect", "Airflow has a default delay of up to 30 seconds to detect a new task", "Airflow has a default delay of up to 5 minutes to detect a new task"], correct: [2], type: "single", category: "Troubleshooting", explanation: "Airflow's min_file_process_interval defaults to 30 seconds, which controls how often existing DAG files are re-parsed." },
            { id: 10, question: "What is the role of the executor in Airflow?", options: ["It deletes unwanted tasks", "It defines how tasks are executed and on which system", "It executes tasks", "It schedules tasks"], correct: [1], type: "single", category: "Architecture", explanation: "The executor defines the mechanism and environment for running tasks. Types include: SequentialExecutor, LocalExecutor, CeleryExecutor, and KubernetesExecutor." },
            { id: 11, question: "What mode is considered best practice when a sensor's poke_interval parameter value is set to greater than 5 minutes?", options: ["reschedule", "poke"], correct: [0], type: "single", category: "Sensors", explanation: "When poke_interval is long (> 5 minutes), reschedule mode is best because it releases the worker slot between pokes, avoiding resource waste." },
            { id: 12, question: "What would be the value of the schedule parameter of a DAG that runs every 10 minutes but not on weekends?", options: ["schedule='/10 * * * *'", "schedule='*/10 * * * 1-5'", "schedule=timedelta(minutes=10)", "schedule='*/10 * * * M-F'"], correct: [1], type: "single", category: "Scheduling", explanation: "The cron expression '*/10 * * * 1-5' means: every 10 minutes, every hour, every day of month, every month, Monday through Friday (1-5)." },
            { id: 13, question: "Which of the following are valid values for scheduling a DAG in Airflow? (select all that apply)", options: ["Timedelta", "Integers", "Calendar", "Cron"], correct: [0, 3], type: "multiple", category: "Scheduling", explanation: "Valid schedule values include: Cron strings, Timedelta objects, Timetables, None, and Dataset triggers. Integers and Calendar are not valid." },
            { id: 14, question: "A new DAG file was added to the /dags folder but it doesn't show up on the Airflow UI. Which could be causing the issue? (select all that apply)", options: ["The code doesn't contain 'airflow' or 'dag' words", "The Airflow instance must be restarted", "Airflow has a default delay of up to 5 minutes", "The .airflowignore file has the name of the file"], correct: [0, 2, 3], type: "multiple", category: "Troubleshooting", explanation: "Airflow scans files for 'airflow' and 'dag' keywords before parsing. The dag_dir_list_interval defaults to 300 seconds (5 minutes) for new files." },
            { id: 15, question: "What is the default value for the start_date parameter of a DAG?", options: ["datetime.now()", "datetime(2020, 1, 1)", "None", "Yesterday"], correct: [2], type: "single", category: "DAG Parameters", explanation: "The start_date defaults to None. Without a start_date, the DAG won't be scheduled automatically." },
            { id: 16, question: "Which of the following parameters would set the start date to 2025/01/01?", options: ["start_date=datetime(2025, 1, 1)", "schedule=datetime(2025, 1, 1)", "start_date=datetime(1, 1, 2025)", "start_date='2025/01/01'"], correct: [0], type: "single", category: "DAG Parameters", explanation: "The correct format is start_date=datetime(year, month, day), so datetime(2025, 1, 1)." },
            { id: 17, question: "Assume a DAG is scheduled to run daily at 00:00. The start date is January 1st, 2025. What is the logical_date for the first DAG Run?", options: ["2025/01/01 00:00", "2025/01/02 00:00", "2025/01/01 00:01", "2025/01/02 23:59"], correct: [0], type: "single", category: "Scheduling", explanation: "The logical_date represents the start of the data interval being processed, not when the DAG runs. For the first run, logical_date = 2025-01-01 00:00." },
            { id: 18, question: "What is a limitation of using XComs? (select all that apply)", options: ["XComs are the only way to share data between tasks", "There must be a defined DAG with at least one task", "The amount of data that can be given to an XCom is limited", "XComs can only be used with a maximum of two tasks"], correct: [1, 2], type: "multiple", category: "XCom", explanation: "XCom limitations: requires task context, and size is limited (stored in metadata DB). XCom is NOT the only way to share data." },
            { id: 19, question: "Which of the following ways allows the code to avoid defining a DAG object in all operators (dag=dag)? (select all that apply)", options: ["By defining tasks within a function decorated by @dag", "By giving all tasks the same task_id", "By instantiating the DAG object with the context manager 'with'", "By creating a default_argument dictionary"], correct: [0, 2], type: "multiple", category: "DAG Definition", explanation: "Using @dag decorator or 'with DAG(...) as dag:' context manager auto-associates tasks defined within." },
            { id: 20, question: "What is the default timezone in Airflow?", options: ["Local timezone", "EST", "UTC", "PST"], correct: [2], type: "single", category: "Configuration", explanation: "Airflow uses UTC as the default timezone for all internal operations." },
            { id: 21, question: "What is the typical journey of a task?", options: ["No status ‚Üí Scheduled ‚Üí Queued ‚Üí Running ‚Üí Success/Failure", "Queued ‚Üí Scheduled ‚Üí Running ‚Üí Success/Failure", "No status ‚Üí Queued ‚Üí Scheduled ‚Üí Running ‚Üí Success/Failure", "Scheduled ‚Üí Queued ‚Üí Running ‚Üí Success/Failure"], correct: [0], type: "single", category: "Core Concepts", explanation: "The task lifecycle: No status (created) ‚Üí Scheduled (ready to run) ‚Üí Queued (sent to executor) ‚Üí Running (worker executing) ‚Üí Success/Failure." },
            { id: 22, question: "Examine the DAG missing start_date and task/dag not called. Which of the following are issues? (select all that apply)", options: ["The start_date parameter is missing", "The tags parameter is missing", "Not calling the task 'python_task'", "Not calling the dag 'my_dag'"], correct: [0, 2, 3], type: "multiple", category: "Troubleshooting", explanation: "Issues: Missing start_date (required for scheduling), task not called, DAG not called. Tags are optional." },
            { id: 23, question: "What is the purpose of setting dependencies between tasks in Airflow?", options: ["To ensure that tasks are executed in the correct order", "To reduce the likelihood of task failures", "To increase the parallelism of task execution", "To improve the performance of the Airflow scheduler"], correct: [0], type: "single", category: "Dependencies", explanation: "Task dependencies define execution order. Dependencies are about correctness, not performance." },
            { id: 24, question: "What is a XCom?", options: ["A real-time communication protocol", "A way to store data between tasks", "A data serialization tool", "A type of task in a DAG"], correct: [1], type: "single", category: "XCom", explanation: "XCom (Cross-Communication) is Airflow's mechanism for tasks to share and pass small amounts of data." },
            { id: 25, question: "What is the default timeout value of a sensor?", options: ["7 hours", "7 days", "1 day", "1 minute"], correct: [1], type: "single", category: "Sensors", explanation: "Sensors have a default timeout of 7 days (604,800 seconds)." },
            { id: 26, question: "What does the bar chart column represent in the Airflow DAGs view?", options: ["The status of all future DAG runs", "The status of previous DAG runs only", "Task instances along with their states", "Past and current DAG runs along with their states"], correct: [3], type: "single", category: "UI", explanation: "The bar chart shows a DAG run history visualization‚Äîrecent DAG runs and their statuses." },
            { id: 27, question: "Why doesn't the DAG show up on the Airflow UI? (my_dag function not called)", options: ["my_dag isn't called", "The schedule parameter is missing", "The catchup parameter is missing", "The start_date parameter is incorrectly formatted"], correct: [0], type: "single", category: "Troubleshooting", explanation: "When using the @dag decorator, you must call the decorated function to instantiate the DAG." },
            { id: 28, question: "Assuming current date is 2025/01/04, how many DAG runs will occur after unpausing a DAG with start_date 2025/01/01, @daily schedule, and default catchup?", options: ["4", "1", "0", "2"], correct: [0], type: "single", category: "Scheduling", explanation: "With catchup=True (default) and @daily schedule from Jan 1 to Jan 4, there will be 4 completed intervals." },
            { id: 29, question: "Once a DAG has a unique ID, which parameter defines when it will start being scheduled?", options: ["schedule", "end_date", "start_date", "dag_id"], correct: [2], type: "single", category: "DAG Parameters", explanation: "The start_date parameter defines when the DAG starts being scheduled." },
            { id: 30, question: "What task dependency relationship results in: t0 ‚Üí t1 ‚Üí t2 ‚Üí t3 (linear flow)?", options: ["[t0, t1] >> [t2, t3]", "[t0, t1] >> t2 >> t3", "t0 >> t1 >> t2 >> t3", "t0 >> t1 >> [t2, t3]"], correct: [2], type: "single", category: "Dependencies", explanation: "t0 >> t1 >> t2 >> t3 creates a linear sequential flow." },
            { id: 31, question: "Which of the following is a valid way to create a data pipeline in Airflow? (select all that apply)", options: ["Using with DAG()", "Using the DAG class and defining the dag parameter in an operator", "Creating a Python function called DAG", "Using the @dag decorator"], correct: [0, 1, 3], type: "multiple", category: "DAG Definition", explanation: "Valid ways: @dag decorator, with DAG() context manager, and DAG class with dag= parameter." },
            { id: 32, question: "Is it still possible to backfill your DAGs even if the catchup parameter is set to false?", options: ["No, when catchup is set to False, it is impossible to backfill", "Yes, with the UI, API, or CLI"], correct: [1], type: "single", category: "Backfill", explanation: "catchup=False only prevents automatic backfilling. You can still manually backfill using CLI, UI, or API." },
            { id: 33, question: "Would this DAG run properly? (task_a() >> task_b - missing parentheses on task_b)", options: ["Yes", "No"], correct: [1], type: "single", category: "Troubleshooting", explanation: "No, this would fail. task_b without parentheses is a _TaskDecorator object, not a task instance." },
            { id: 34, question: "What does the 'Latest Run' column represent in the Airflow UI?", options: ["The logical date of the latest DAG run", "The interval of time between each DAG run", "The end date/time of the most recent DAG run", "The date when the DAG is scheduled to run next"], correct: [0], type: "single", category: "UI", explanation: "The 'Latest Run' column shows the logical_date of the most recent DAG run." },
            { id: 35, question: "A team member notices the provider they need (e.g., Presto) is missing from the connection dropdown. What should they do?", options: ["Reinstall Airflow", "Restart Airflow", "Find a different provider because it's impossible", "Find and install the provider package"], correct: [3], type: "single", category: "Providers", explanation: "Install the provider package: pip install apache-airflow-providers-presto." },
            { id: 36, question: "Which Airflow UI view is most helpful for an overview of all DAG runs and task states?", options: ["Graph view", "Grid view", "DAGs view"], correct: [1], type: "single", category: "UI", explanation: "Grid view shows a matrix of tasks and DAG runs, making it ideal for viewing task states across multiple runs." },
            { id: 37, question: "Which statements are true about a DAG in Airflow? (select all that apply)", options: ["It is good practice to have loops in a DAG", "A DAG is a programming language for data analysis", "DAG stands for Directed Acyclic Graph", "A DAG's nodes define tasks, edges define dependencies"], correct: [2, 3], type: "multiple", category: "Core Concepts", explanation: "DAG = Directed Acyclic Graph. Nodes are tasks, edges are dependencies. Loops are NOT allowed." },
            { id: 38, question: "What is the purpose of an Airflow variable? (select all that apply)", options: ["To store a XCom", "To reuse a value across multiple DAGs", "To store large amounts of data", "To avoid hardcoding a value"], correct: [1, 3], type: "multiple", category: "Variables", explanation: "Variables store global config values accessible across DAGs and help avoid hardcoding." },
            { id: 39, question: "Which Airflow CLI command runs a task without checking dependencies or recording state?", options: ["airflow tasks start", "airflow dags test", "airflow standalone", "airflow tasks test"], correct: [3], type: "single", category: "CLI", explanation: "airflow tasks test runs a single task in isolation without checking dependencies or recording state." },
            { id: 40, question: "What types of data can be stored in an Airflow variable? (select all that apply)", options: ["Integers", "Strings", "Python Dataclasses", "JSON"], correct: [1, 3], type: "multiple", category: "Variables", explanation: "Airflow variables natively support Strings and JSON (with deserialize_json=True)." },
            { id: 41, question: "Which of the following best describes what a Transfer Operator does?", options: ["Moves data between different sources, destinations, or storage systems", "Transforms data into a different format", "Sends notifications during workflow execution", "Evaluates conditions for workflow branching"], correct: [0], type: "single", category: "Operators", explanation: "Transfer Operators move data from one system to another." },
            { id: 42, question: "What is the purpose of the default_args parameter in a DAG?", options: ["It specifies the schedule interval", "It specifies the operator a DAG will use", "It specifies default parameters for at most one task", "It specifies default parameters for all tasks in a DAG"], correct: [3], type: "single", category: "DAG Parameters", explanation: "default_args is a dictionary of default values automatically applied to ALL tasks in the DAG." },
            { id: 43, question: "Which of the following best describes what a Sensor Operator does?", options: ["Waits for a condition to be met before proceeding", "Evaluates conditions for workflow branching", "Sends notifications during execution", "Provides utility functions for workflow management"], correct: [0], type: "single", category: "Sensors", explanation: "Sensors wait for a specific condition to become true before allowing downstream tasks to proceed." },
            { id: 44, question: "Would [t0, t1] >> t2 >> [t3, t4] >> t5 work as a valid task dependency?", options: ["No", "Yes"], correct: [1], type: "single", category: "Dependencies", explanation: "Yes, this is valid Airflow syntax. It creates: t0,t1 (parallel) ‚Üí t2 ‚Üí t3,t4 (parallel) ‚Üí t5." },
            { id: 45, question: "Assuming current date is 2025/01/08 10:00, how many DAG runs occur for a DAG with start_date 2025/01/05 and catchup=True?", options: ["4", "2", "1", "3"], correct: [3], type: "single", category: "Scheduling", explanation: "3 completed intervals: Jan 5‚Üí6, Jan 6‚Üí7, Jan 7‚Üí8. The Jan 8‚Üí9 interval hasn't completed yet." },
            { id: 46, question: "Which parameters are optional when creating a DAG without the @dag decorator? (select all that apply)", options: ["schedule_interval", "start_date", "default_args", "dag_id"], correct: [0, 1, 2], type: "multiple", category: "DAG Parameters", explanation: "Only dag_id is REQUIRED. schedule_interval, start_date, and default_args are optional." },
            { id: 47, question: "A CEO wants a dashboard that analyzes user behavior. Which describes how Airflow can help?", options: ["Airflow as the primary database for user information", "Airflow to schedule data pipelines that feed a data warehouse", "Airflow embedded to analyze click events and present dashboards", "Airflow to build dashboards directly in the Airflow UI"], correct: [1], type: "single", category: "Use Cases", explanation: "Airflow orchestrates data pipelines‚Äîit's not a database, analytics tool, or dashboard builder." },
            { id: 48, question: "Can an Airflow variable created via environment variable still be accessed in DAGs even if not visible in UI?", options: ["Yes", "No"], correct: [0], type: "single", category: "Variables", explanation: "Yes! Variables set via AIRFLOW_VAR_* can be accessed in DAGs using Variable.get()." },
            { id: 49, question: "What task dependency results from chain(t0, t1, [t2, t3], [t4, t5], t6)?", options: ["chain(t0, t1, [t2, t4], [t3, t5], t6)", "t0 >> t1 >> [t2, t3] >> [t4, t5] >> t6", "chain(t0, t1, [t2, t3], [t4, t5], t6)", "[t0, t1] >> t2 >> t3 >> t4 >> [t5, t6]"], correct: [2], type: "single", category: "Dependencies", explanation: "chain() with lists connects corresponding elements in parallel." },
            { id: 50, question: "Which of the following is a valid way to create a connection in Airflow? (select all that apply)", options: ["Airflow CLI", "In an XCOM", "Airflow UI", "Environment Variables"], correct: [0, 2, 3], type: "multiple", category: "Connections", explanation: "Valid ways: CLI, UI, Environment Variables (AIRFLOW_CONN_*). XCom is for task-to-task data." },
            { id: 51, question: "What mode is best practice when a sensor's poke_interval is less than 5 minutes?", options: ["reschedule", "poke"], correct: [1], type: "single", category: "Sensors", explanation: "For short intervals (< 5 min), poke mode is best." },
            { id: 52, question: "In a typical Airflow setup, what folder is parsed by the scheduler for new DAG files?", options: ["/plugins folder", "/dags folder", "/include folder", "/airflow folder"], correct: [1], type: "single", category: "Configuration", explanation: "The /dags folder is where DAG files are stored and parsed." },
            { id: 53, question: "What method allows an Airflow user to add data to XComs?", options: ["Providing data to the xcom parameter of DAG", "Executing the method xcom_push", "Executing the method xcom_add", "Executing the method xcom_pull"], correct: [1], type: "single", category: "XCom", explanation: "Use xcom_push to add/push data to XCom." },
            { id: 54, question: "What does it mean when a task has the status 'queued'?", options: ["The task is running in a worker", "The task is executed immediately", "The task is waiting to be scheduled", "The task has been assigned to an Executor and is awaiting a worker"], correct: [3], type: "single", category: "Core Concepts", explanation: "Queued status means the scheduler sent the task to the executor, waiting for an available worker." },
            { id: 55, question: "Is running a daily SQL script that aggregates performance data a use case for Airflow?", options: ["No", "Yes"], correct: [1], type: "single", category: "Use Cases", explanation: "Yes! This is a perfect use case for Airflow." },
            { id: 56, question: "What is the purpose of the PythonOperator in Airflow?", options: ["To deploy Python packages to remote servers", "To execute Python code as a task in a DAG", "To schedule Python scripts on a regular basis", "To manage Python virtual environments"], correct: [1], type: "single", category: "Operators", explanation: "PythonOperator executes a Python callable (function) as a task within a DAG." },
            { id: 57, question: "Is a data team's need for automated failure notifications a use case for Airflow?", options: ["No", "Yes"], correct: [1], type: "single", category: "Use Cases", explanation: "Yes! Airflow provides email_on_failure, Slack notifications, custom callbacks, and built-in monitoring." },
            { id: 58, question: "Which is the correct way to define an Airflow variable named 'customer_folder' with value 'my_folder' using environment variable?", options: ["AIRFLOW_VARIABLE_CUSTOMER_FOLDER='my_folder'", "CUSTOMER_FOLDER='my_folder'", "AIRFLOW_VAR_CUSTOMER_FOLDER='my_folder'", "AIRFLOW_CUSTOMER_FOLDER='my_folder'"], correct: [2], type: "single", category: "Variables", explanation: "Format: AIRFLOW_VAR_<VARIABLE_NAME_UPPERCASE>=value." },
            { id: 59, question: "What task dependency results from: t0 ‚Üí t1 ‚Üí t2 ‚Üí t3 (all sequential)?", options: ["t3 << t2 << t1 << t0", "t0 >> t1 >> t2 >> t3", "t0 >> [t1, t2] >> t3", "t0 >> [t1, t2, t3]"], correct: [0, 1], type: "multiple", category: "Dependencies", explanation: "Both t0 >> t1 >> t2 >> t3 and t3 << t2 << t1 << t0 create the same linear dependency." },
            { id: 60, question: "Which Airflow CLI command shows the Python version the environment is running?", options: ["airflow version", "airflow python version", "airflow info", "airflow standalone"], correct: [2], type: "single", category: "CLI", explanation: "airflow info displays comprehensive environment information including Python version." },
            { id: 61, question: "Which Airflow UI view is best for understanding task dependencies?", options: ["Graph view", "Grid view", "DAGs view"], correct: [0], type: "single", category: "UI", explanation: "Graph view displays the DAG as a visual flowchart, showing tasks as nodes and dependencies as arrows." },
            { id: 62, question: "What is an Airflow provider?", options: ["A configuration for task concurrency control", "A separate Python package that extends Airflow's functionality", "A Docker image that installs Airflow", "Core operators like PythonOperator and BashOperator"], correct: [1], type: "single", category: "Providers", explanation: "Providers are separate Python packages that add integrations with external systems." },
            { id: 63, question: "Is the SQLSensor with poke_interval=30 configured correctly to check every 30 minutes?", options: ["Yes", "No"], correct: [1], type: "single", category: "Sensors", explanation: "No! poke_interval is in SECONDS, not minutes. For 30 minutes, use poke_interval=1800." },
            { id: 64, question: "Which Airflow CLI command is necessary to create the metadata database?", options: ["airflow db start", "airflow db reset", "airflow db check", "airflow db migrate"], correct: [3], type: "single", category: "CLI", explanation: "airflow db migrate creates/upgrades the metadata database schema." },
            { id: 65, question: "Examining the error '_TaskDecorator' object has no attribute 'update_relative', which solution resolves this?", options: ["Calling the task explicitly in task dependencies", "Changing the format of start_date", "Importing the correct DAG object", "Not enough information"], correct: [0], type: "single", category: "Troubleshooting", explanation: "This error occurs when setting dependencies on decorator objects. Call the tasks: task_a() >> task_b()." },
            { id: 66, question: "What method allows an Airflow user to get data from an XCom?", options: ["Executing xcom_push", "Executing xcom_add", "Executing xcom_pull", "Providing data to xcom parameter of DAG"], correct: [2], type: "single", category: "XCom", explanation: "Use xcom_pull to retrieve data from XCom." },
            { id: 67, question: "Is t0 >> t1 >> t2 >> t3 equivalent to t3 << t2 << t1 << t0?", options: ["No", "Yes"], correct: [1], type: "single", category: "Dependencies", explanation: "Yes! Both create the same dependency chain: t0 ‚Üí t1 ‚Üí t2 ‚Üí t3." },
            { id: 68, question: "In which place do Airflow users set up dependencies between tasks?", options: ["In a Python file in the 'includes' directory", "In the DAG file itself", "In the Airflow UI", "In a separate configuration file"], correct: [1], type: "single", category: "DAG Definition", explanation: "Task dependencies are defined directly in the DAG Python file." },
            { id: 69, question: "What is the purpose of the catchup parameter in a DAG?", options: ["Determines the schedule interval", "Determines whether DAG runs in the future", "Determines the number of retries", "Determines whether DAG runs retroactively for missed intervals"], correct: [3], type: "single", category: "DAG Parameters", explanation: "catchup controls whether Airflow backfills past intervals." },
            { id: 70, question: "Which returns a variable named 'my_json' as a Python dictionary?", options: ["Variable.retrieve('my_json', deserialize_json=True)", "Variable.get('my_json', deserialize_json=True)", "Variable.retrieve('my_json', deserialize_json=False)", "Variable.get('my_json')"], correct: [1], type: "single", category: "Variables", explanation: "Use Variable.get() with deserialize_json=True to get JSON as a Python dict." },
            { id: 71, question: "Would [t0, t1] >> [t2, t3] work as a valid task dependency?", options: ["No", "Yes"], correct: [1], type: "single", category: "Dependencies", explanation: "Yes! This creates cross-dependencies: t0 and t1 must complete before t2 or t3 can start." },
            { id: 72, question: "A DAG was designed to fetch files daily at 7:00 AM. What schedule value achieves this?", options: ["schedule='7 * * * *'", "schedule='0 7 * * *'", "schedule=timedelta(hours=6)", "schedule=timedelta(hours=7)"], correct: [1], type: "single", category: "Scheduling", explanation: "Cron '0 7 * * *' means: minute 0, hour 7, every day." },
            { id: 73, question: "What is the default amount of time for a new DAG file to appear in the Airflow UI?", options: ["1 minute", "30 seconds", "5 minutes", "1 second"], correct: [2], type: "single", category: "Configuration", explanation: "dag_dir_list_interval defaults to 300 seconds (5 minutes) for scanning new DAG files." },
            { id: 74, question: "Examining the Airflow UI showing only 2 DAGs when expecting 5, why?", options: ["5-minute default delay to see new DAGs", "A filter is applied for tags", "30-second default delay", "Airflow is experiencing an error"], correct: [1], type: "single", category: "UI", explanation: "A tag filter is applied. Remove the filter to see all 5 DAGs." },
            { id: 75, question: "What is the purpose of the schedule parameter in a DAG?", options: ["Defines when the DAG starts being scheduled", "Defines how often the DAG runs", "Defines when the DAG stops being scheduled", "Defines the timezone for the DAG"], correct: [1], type: "single", category: "DAG Parameters", explanation: "The schedule parameter defines how often the DAG runs (@daily, cron expressions, timedelta)." }
        ];

        let userAnswers = {};
        let quizSubmitted = false;

        function showMode(mode) {
            document.querySelectorAll('.cert-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(mode + '-section').classList.add('active');
            event.target.classList.add('active');
            
            if (mode === 'study' && !document.getElementById('study-content').innerHTML) {
                renderStudyMode();
            } else if (mode === 'quiz' && !document.getElementById('quiz-content').innerHTML) {
                renderQuizMode();
            } else if (mode === 'answers' && !document.getElementById('answers-content').innerHTML) {
                renderAnswersMode();
            }
            
            window.scrollTo(0, 0);
        }

        function renderStudyMode() {
            const container = document.getElementById('study-content');
            let html = '';
            
            questions.forEach((q) => {
                const correctOptions = q.correct.map(i => q.options[i]).join(', ');
                html += `
                    <div class="question-card">
                        <span class="q-number">Question ${q.id}</span>
                        <span class="q-category">${q.category}</span>
                        <div class="q-text">${q.question.replace(/\n/g, '<br>')}</div>
                        <div class="options-list">
                            ${q.options.map((opt, i) => `
                                <div class="option-item ${q.correct.includes(i) ? 'correct-highlight' : ''}">
                                    ${q.type === 'multiple' ? '‚òê' : '‚óã'} ${opt}
                                </div>
                            `).join('')}
                        </div>
                        <div class="correct-badge">‚úì Answer: ${correctOptions}</div>
                        <div class="explanation-box">
                            <h4>üìñ Explanation</h4>
                            <p>${q.explanation}</p>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function renderQuizMode() {
            const container = document.getElementById('quiz-content');
            let html = '';
            
            questions.forEach((q) => {
                const inputType = q.type === 'multiple' ? 'checkbox' : 'radio';
                html += `
                    <div class="question-card" id="quiz-q-${q.id}">
                        <span class="q-number">Question ${q.id}</span>
                        <span class="q-category">${q.category}</span>
                        <div class="q-text">${q.question.replace(/\n/g, '<br>')}</div>
                        <div class="options-list">
                            ${q.options.map((opt, i) => `
                                <label class="option-item" id="quiz-q-${q.id}-opt-${i}">
                                    <input type="${inputType}" name="q${q.id}" value="${i}" 
                                           onchange="recordAnswer(${q.id}, ${i}, '${q.type}')">
                                    ${opt}
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function renderAnswersMode() {
            const container = document.getElementById('answers-content');
            let html = '';
            
            questions.forEach((q) => {
                html += `
                    <div class="question-card">
                        <span class="q-number">Question ${q.id}</span>
                        <span class="q-category">${q.category}</span>
                        <div class="q-text">${q.question.replace(/\n/g, '<br>')}</div>
                        <div class="options-list">
                            ${q.options.map((opt, i) => `
                                <div class="option-item ${q.correct.includes(i) ? 'correct-highlight' : ''}">
                                    ${q.type === 'multiple' ? '‚òê' : '‚óã'} ${opt}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function recordAnswer(questionId, optionIndex, type) {
            if (quizSubmitted) return;
            
            if (type === 'multiple') {
                if (!userAnswers[questionId]) {
                    userAnswers[questionId] = [];
                }
                const idx = userAnswers[questionId].indexOf(optionIndex);
                if (idx > -1) {
                    userAnswers[questionId].splice(idx, 1);
                } else {
                    userAnswers[questionId].push(optionIndex);
                }
            } else {
                userAnswers[questionId] = [optionIndex];
            }
        }

        function submitQuiz() {
            if (quizSubmitted) return;
            quizSubmitted = true;
            
            let correct = 0;
            let incorrect = 0;
            
            questions.forEach(q => {
                const userAnswer = userAnswers[q.id] || [];
                const isCorrect = arraysEqual(userAnswer.sort(), [...q.correct].sort());
                
                if (isCorrect) {
                    correct++;
                } else {
                    incorrect++;
                }
                
                q.options.forEach((opt, i) => {
                    const optEl = document.getElementById(`quiz-q-${q.id}-opt-${i}`);
                    if (optEl) {
                        optEl.classList.remove('user-correct', 'user-wrong');
                        if (userAnswer.includes(i) && q.correct.includes(i)) {
                            optEl.classList.add('user-correct');
                        } else if (userAnswer.includes(i) && !q.correct.includes(i)) {
                            optEl.classList.add('user-wrong');
                        }
                    }
                });
            });
            
            const percentage = Math.round((correct / questions.length) * 100);
            
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('score-value').textContent = percentage + '%';
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('correct-count').textContent = correct;
            document.getElementById('incorrect-count').textContent = incorrect;
            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('show-answers-btn').classList.remove('hidden');
            
            const message = percentage >= 70 ? 
                'üéâ Congratulations! You passed!' : 
                'üìö Keep studying! You need 70% to pass.';
            document.getElementById('score-message').textContent = message;
            document.getElementById('score-message').className = 'score-label ' + (percentage >= 70 ? 'pass' : 'fail');
            
            document.querySelectorAll('#quiz-content input').forEach(input => {
                input.disabled = true;
            });
            
            window.scrollTo(0, 0);
        }

        function revealAnswers() {
            questions.forEach(q => {
                q.options.forEach((opt, i) => {
                    const optEl = document.getElementById(`quiz-q-${q.id}-opt-${i}`);
                    if (optEl && q.correct.includes(i)) {
                        optEl.classList.add('correct-highlight');
                    }
                });
            });
        }

        function resetQuiz() {
            quizSubmitted = false;
            userAnswers = {};
            
            document.getElementById('results').classList.add('hidden');
            document.getElementById('submit-btn').classList.remove('hidden');
            document.getElementById('show-answers-btn').classList.add('hidden');
            
            document.querySelectorAll('#quiz-content input').forEach(input => {
                input.disabled = false;
                input.checked = false;
            });
            
            document.querySelectorAll('#quiz-content .option-item').forEach(opt => {
                opt.classList.remove('user-correct', 'user-wrong', 'correct-highlight');
            });
            
            window.scrollTo(0, 0);
        }

        function arraysEqual(a, b) {
            if (a.length !== b.length) return false;
            for (let i = 0; i < a.length; i++) {
                if (a[i] !== b[i]) return false;
            }
            return true;
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Hub Navigation
        function goToHub() {
            window.location.href = '../index.html';
        }

        function goToPython() {
            window.location.href = '../python_course/index.html';
        }

        // Scroll button visibility
        window.addEventListener('scroll', () => {
            const scrollBtn = document.getElementById('scroll-top');
            if (window.scrollY > 500) {
                scrollBtn.classList.add('visible');
            } else {
                scrollBtn.classList.remove('visible');
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            renderStudyMode();
        });
    </script>
</body>
</html>

